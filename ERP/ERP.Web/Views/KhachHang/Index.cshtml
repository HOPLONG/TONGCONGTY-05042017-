@model IEnumerable<ERP.Web.Models.Database.KH>

@{
    ViewBag.Title = "Index";
}
<link href="~/Content/self-writing/css/KhachHang.css" rel="stylesheet" />
<script src="http://malsup.github.com/jquery.form.js"></script>
<style>
    #myModal .col-md-12 {
        margin: 10px 0px;
    }
</style>
<div ng-app="myApp" ng-controller="khachhangCtrl">
    <div class="content">
        <div id="quick-access">
            <form class="form-inline quick-search-form" role="form" action="#">
                <div class="form-group" style="width: 100%">
                    <input type="text" style="width: 60%" class="form-control" placeholder="Type Customer Name You Want To Search Here" ng-model="search_text">
                </div>
            </form>
        </div>


        <button type="button" class="btn btn-info" data-toggle="modal" data-target="#myModal">Add New Customer</button>
        <input type="button" class="btn btn-info" onclick="location.href='/ChuyenSale/Index';" value="Chuyển Sale" />
        <input type="button" class="btn btn-info" onclick="location.href = '/KhachHang/TimKiem_KhachHang';" value="Tìm kiếm khách" />

        <!-- Modal Add New khách hàng -->
        <div class="modal fade" id="myModal" role="dialog" tabindex="-1">
            <div class="modal-dialog modal-lg" style="width: 90%">
                <div class="modal-content" style="height: 100%">

                    <div class="modal-body">
                        <form class="form-horizontal" action="/KhachHang/Index" method="post">
                            <p style="font-size: x-large; color: blue; font-weight: 700">Thông tin chung</p>
                            <div class="form-group">
                                <div class="col-md-12">
                                    @*<div class="col-sm-4">
                                            <input type="text" class="form-control" id="addtencongty" placeholder="Mã khách hàng" ng-model="arraythongtin.ma_khach_hang">
                                        </div>*@
                                    <div ng-controller="imgCtrl" class="col-md-8">
                                        <div class="col-md-6">
                                            @Html.AntiForgeryToken()
                                            <input type='file' name="files" id="imgInp" style="width: 25%;display: inline-block" />
                                            <input type="submit" value="Upload Ảnh" style="width: 25%;display: inline-block;float: right" />
                                        </div>
                                        <div class="col-md-6">
                                            <img id="blah" src="#" height="100" width="150" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <div class="col-sm-10">
                                        <input type="text" class="form-control" id="addtencongty" placeholder="Tên công ty" ng-model="arraythongtin.ten_cong_ty">
                                    </div>
                                </div>

                            </div>
                            <div class="form-group">
                                <div class="col-md-6">
                                    <label class="col-sm-2 control-label">Phân loại khách hàng</label>
                                    <select ng-model="ma_loai_khach" class="form-control col-sm-3 input-md" style="width: 25% !important">
                                        <option ng-repeat="phanloai in list_phanloai" value="{{phanloai.MA_LOAI_KHACH}}">{{phanloai.TEN_LOAI_KHACH}}</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <div class="col-sm-10">
                                        <input type="text" placeholder="Nhóm ngành" class="form-control" id="addvpgiaodich" ng-model="nhom_nganh">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <div class="col-sm-10">
                                        <input type="text" placeholder="Văn phòng giao dịch" class="form-control" id="addvpgiaodich" ng-model="arraythongtin.van_phong_giao_dich">
                                    </div>
                                </div>

                            </div>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <div class="col-sm-10">
                                        <input type="text" class="form-control" placeholder="Địa chỉ xuất hóa đơn" id="adddiachixuathoadon" ng-model="arraythongtin.dia_chi_xuat_hoa_don">
                                    </div>
                                </div>

                            </div>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control" placeholder="Mã số thuế" id="addmasothue" ng-model="arraythongtin.ma_so_thue">
                                    </div>
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control" placeholder="Website" id="addwebsite" ng-model="arraythongtin.website">
                                    </div>
                                    <div class="col-sm-2">
                                        <input type="tel" class="form-control" placeholder="Số điện thoại" id="addsomayban" ng-model="arraythongtin.hotline">
                                    </div>
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control" placeholder="Fax" id="addfax" ng-model="arraythongtin.fax">
                                    </div>
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control" placeholder="Tỉnh" id="addfax" ng-model="arraythongtin.tinh">
                                    </div>
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control" placeholder="Quốc gia" id="addfax" ng-model="arraythongtin.quoc_gia">
                                    </div>
                                </div>

                            </div>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <label class="col-sm-2 control-label">Điều khoản thanh toán</label>
                                    <div class="col-sm-2">
                                        <select class="form-control" ng-model="arraythongtin.dieu_khoan_thanh_toan" id="adddieukhoanthanhtoan"
                                                data-ng-options="item as item for item in dieukhoantt"></select>
                                    </div>
                                    <div class="col-sm-2">
                                        <input type="number" class="form-control" placeholder="Số ngày được nợ" id="addsongayduocno" ng-model="arraythongtin.so_ngay_duoc_no">
                                    </div>
                                    <div class="col-sm-2">
                                        <input type="number" class="form-control" placeholder="Số nợ tối đa" id="addsonotoida" ng-model="arraythongtin.so_no_toi_da">
                                    </div>
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control" placeholder="Email" id="addemail" ng-model="arraythongtin.email">
                                    </div>
                                </div>

                            </div>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <div class="col-sm-12">
                                        <textarea class="form-control" rows="3" placeholder="Ghi chú" id="addghichu" ng-model="arraythongtin.ghi_chu"></textarea>
                                    </div>
                                </div>

                            </div>

                            <p style="font-size: x-large; color: blue; font-weight: 700">Tài khoản khách hàng</p>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <table class="table">
                                        <thead class="table-header-popup" style="background-color: #d7f1f9">
                                            <tr>
                                                <th style="text-align: center">Số tài khoản</th>
                                                <th style="text-align: center">Tên tài khoản</th>
                                                <th style="text-align: center">Tên ngân hàng</th>
                                                <th style="text-align: center">Chi nhánh</th>
                                                <th style="text-align: center">Tỉnh thành phố</th>
                                                <th style="text-align: center">Loại tài khoản</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="i in range(0,2)">
                                                <td><input type="text" class="form-control" ng-model="arraytaikhoan[$index].so_tai_khoan"></td>
                                                <td><input type="text" class="form-control" ng-model="arraytaikhoan[$index].ten_tai_khoan"></td>
                                                <td><input type="text" class="form-control" ng-model="arraytaikhoan[$index].ten_ngan_hang"></td>
                                                <td><input type="text" class="form-control" ng-model="arraytaikhoan[$index].chi_nhanh"></td>
                                                <td><input type="text" class="form-control" ng-model="arraytaikhoan[$index].tinh_tp"></td>
                                                <td>
                                                    <select ng-model="arraytaikhoan[$index].loai_tai_khoan" class="form-control input-md">
                                                        <option ng-repeat="loaitaikhoan in list_loaitaikhoan" value="{{loaitaikhoan.MA_LOAI}}">{{loaitaikhoan.TEN_LOAI}}</option>
                                                    </select>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                            </div>

                            <p style="font-size: x-large; color: blue; font-weight: 700">Liên hệ khách hàng</p>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <table class="table">
                                        <thead class="table-header-popup" style="background-color: #d7f1f9">
                                            <tr>
                                                <th style="text-align: center">Người liên hệ</th>
                                                <th style="text-align: center">Chức vụ</th>
                                                <th style="text-align: center">Phòng ban</th>
                                                <th style="text-align: center">Ngày sinh</th>
                                                <th style="text-align: center">Giới tính</th>
                                                <th style="text-align: center">SĐT</th>
                                                <th style="text-align: center">Email</th>
                                                <th style="text-align: center">Skype</th>
                                                <th style="text-align: center">Facebook</th>
                                                <th style="text-align: center">Sale phụ trách</th>
                                                <th style="text-align: center">Sales Mới</th>
                                                <th style="text-align: center">Sales Cũ</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="i in range(0,2)">
                                                <td><input style="height: 68px" type="text" class="form-control" ng-model="arraylienhe[$index].nguoi_lien_he"></td>
                                                <td><input style="height: 68px" type="text" class="form-control" ng-model="arraylienhe[$index].chuc_vu"></td>
                                                <td><input style="height: 68px" type="text" class="form-control" ng-model="arraylienhe[$index].phong_ban"></td>
                                                <td>
                                                    <input style="height: 68px" type="text" class="form-control" ng-model="arraylienhe[$index].ngay_sinh">
                                                </td>
                                                <td>
                                                    <input style="height: 68px" type="text" class="form-control" ng-model="arraylienhe[$index].gioi_tinh">
                                                </td>
                                                <td>
                                                    <input type="tel" class="form-control" ng-model="arraylienhe[$index].so_dien_thoai1" placeholder="Số điện thoại 1">
                                                    <input type="tel" class="form-control" ng-model="arraylienhe[$index].so_dien_thoai2" placeholder="Số điện thoại 2">
                                                </td>
                                                <td>
                                                    <input type="text" class="form-control" ng-model="arraylienhe[$index].email_ca_nhan" placeholder="Email cá nhân">
                                                    <input type="text" class="form-control" ng-model="arraylienhe[$index].email_cong_ty" placeholder="Email công ty">
                                                </td>
                                                <td><input style="height: 68px" type="text" class="form-control" ng-model="arraylienhe[$index].skype"></td>
                                                <td><input style="height: 68px" type="text" class="form-control" ng-model="arraylienhe[$index].facebook"></td>
                                                <td>
                                                    <md-input-container>
                                                        <md-select ng-model="arraylienhe[$index].sales_phu_trach">
                                                            <md-option><em>None</em></md-option>
                                                            <md-option ng-repeat="state in list_nhanvienkd" ng-value="state.USERNAME">
                                                                {{state.HO_VA_TEN}}
                                                            </md-option>
                                                        </md-select>
                                                    </md-input-container>
                                                </td>
                                                <td>
                                                    <input type="checkbox" ng-model="arraylienhe[$index].sales_moi"/>
                                                </td>
                                                <td>
                                                    <input type="checkbox" ng-model="arraylienhe[$index].sales_cu" />
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>

                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button id="save" name="save" class="btn" data-dismiss="modal" ng-click="createnew()">Add New</button>
                        <button id="exit" name="exit" class="btn" data-dismiss="modal">Exit</button>
                    </div>
                </div>
            </div>
        </div>
        <!--end modal-->
        <!-- Modal Update khách hàng-->
        <div class="modal fade" id="myEdit" role="dialog" tabindex="-1">
            <div class="modal-dialog modal-lg" style="width: 90%">
                <div class="modal-content" style="height: 100%">

                    <div class="modal-body">
                        <form class="form-horizontal" action="/KhachHang/Index" method="post">
                            <div class="form-group">
                                <div class="col-md-12">
                                    <label for="addmakhachhang" class="col-sm-2 control-label">Mã khách hàng</label>
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control" disabled="disabled" id="addmakhachhang" ng-model="kh.MA_KHACH_HANG">
                                    </div>
                                    <div ng-controller="imgCtrl" class="col-md-8">
                                        <div class="col-md-6">
                                            @Html.AntiForgeryToken()
                                            <input type='file' name="files" id="imgEdit" style="width: 25%;display: inline-block" />
                                            <input type="submit" value="Upload Ảnh" style="width: 25%;display: inline-block;float: right" />
                                        </div>
                                        <div class="col-md-6">
                                            <img id="edit_img" src="#" height="100" width="150" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <label for="addtencongty" class="col-sm-2 control-label">Tên công ty</label>
                                    <div class="col-sm-10">
                                        <input type="text" class="form-control" id="addtencongty" ng-model="kh.TEN_CONG_TY">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <label class="col-sm-2 control-label">Phân loại khách hàng</label>
                                    <div class="col-sm-10">
                                        <div class="container">
                                            <label class="radio-inline" ng-repeat="phanloai in list_phanloai">
                                                <input type="radio" name="optradio" ng-value="phanloai.MA_LOAI_KHACH" ng-model="kh.MA_LOAI_KHACH">{{phanloai.TEN_LOAI_KHACH}}
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <label for="addvpgiaodich" class="col-sm-2 control-label">Văn phòng giao dịch</label>
                                    <div class="col-sm-10">
                                        <input type="text" class="form-control" id="addvpgiaodich" ng-model="kh.VAN_PHONG_GIAO_DICH">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <label for="adddiachixuathoadon" class="col-sm-2 control-label">Địa chỉ xuất hóa đơn</label>
                                    <div class="col-sm-10">
                                        <input type="text" class="form-control" id="adddiachixuathoadon" ng-model="kh.DIA_CHI_XUAT_HOA_DON">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <label for="addmasothue" class="col-sm-2 control-label">Mã số thuế</label>
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control" id="addmasothue" ng-model="kh.MST">
                                    </div>
                                    <label for="addwebsite" class="col-sm-1 control-label">Website</label>
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control" id="addwebsite" ng-model="kh.WEBSITE">
                                    </div>
                                    <label for="addsomayban" class="col-sm-1 control-label">Số máy bàn</label>
                                    <div class="col-sm-2">
                                        <input type="tel" class="form-control" id="addsomayban" ng-model="kh.HOTLINE">
                                    </div>
                                    <label for="addfax" class="col-sm-1 control-label">Fax</label>
                                    <div class="col-sm-1">
                                        <input type="text" class="form-control" id="addfax" ng-model="kh.FAX">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <label class="col-sm-2 control-label">Điều khoản thanh toán</label>
                                    <div class="col-sm-2">
                                        <select class="form-control" ng-model="kh.DIEU_KHOAN_THANH_TOAN" id="adddieukhoanthanhtoan"
                                                data-ng-options="item as item for item in dieukhoantt"></select>
                                    </div>
                                    <label for="addsongayduocno" class="col-sm-2 control-label">Số ngày được nợ</label>
                                    <div class="col-sm-1">
                                        <input type="number" class="form-control" id="addsongayduocno" ng-model="kh.SO_NGAY_DUOC_NO">
                                    </div>
                                    <label for="addsonotoida" class="col-sm-1 control-label">Số nợ tối đa</label>
                                    <div class="col-sm-2">
                                        <input type="number" class="form-control" id="addsonotoida" ng-model="kh.SO_NO_TOI_DA">
                                    </div>
                                    <label for="addemail" class="col-sm-1 control-label">Email</label>
                                    <div class="col-sm-1">
                                        <input type="text" class="form-control" id="addemail" ng-model="kh.EMAIL">
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-md-12">
                                    <label for="addghichu" class="col-sm-2 control-label">Ghi chú</label>
                                    <div class="col-sm-10">
                                        <textarea class="form-control" rows="3" id="addghichu" ng-model="kh.GHI_CHU"></textarea>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button id="save" name="save" class="btn" data-dismiss="modal" ng-click="save(kh.MA_KHACH_HANG,kh.ID)">Save</button>
                        <button id="exit" name="exit" class="btn" data-dismiss="modal">Exit</button>
                    </div>
                </div>
            </div>
        </div>
        <br />
        <!--end modal-->
        <!-- Modal chi tiet lien he -->
        <div class="modal fade" id="chitietlienhe" role="dialog" tabindex="-1">
            <div class="modal-dialog modal-lg" style="width:80%;">
                <div class="modal-content" style="height: 600px;">
                    <div class="modal-body">
                        <div class="col-md-12" style="box-shadow: 3px 3px 3px #ddd">
                            <div class="col-md-6">
                                <table class="table noborder">
                                    <tr>
                                        <td>Tên công ty</td>
                                        <td>{{lienhe.TEN_CONG_TY}}</td>
                                    </tr>
                                    <tr>
                                        <td>Người liên hệ</td>
                                        <td>{{lienhe.NGUOI_LIEN_HE}}</td>
                                    </tr>
                                    <tr>
                                        <td>Chức vụ</td>
                                        <td>{{lienhe.CHUC_VU}}</td>
                                    </tr>
                                    <tr>
                                        <td>Phòng ban</td>
                                        <td>{{lienhe.PHONG_BAN}}</td>
                                    </tr>
                                    <tr>
                                        <td>Ngày sinh:</td>
                                        <td>{{lienhe.NGAY_SINH}}</td>
                                    </tr>

                                    <tr>
                                        <td>Email cá nhân:</td>
                                        <td>{{lienhe.EMAIL_CA_NHAN}}</td>
                                    </tr>
                                    <tr>
                                        <td>Email công ty:</td>
                                        <td>{{lienhe.EMAIL_CONG_TY}}</td>
                                    </tr>
                                    <tr>
                                        <td>Loại sales:</td>
                                        <td ng-if="lienhe.SALES_MOI == true">Sales Mới</td>
                                        <td ng-if="lienhe.SALES_CU == true">Sales Cũ</td>
                                    </tr>
                                </table>
                            </div>
                            <div class="col-md-6">
                                <table class="table noborder">
                                    <tr>
                                        <td>Giới tính:</td>
                                        <td>{{lienhe.GIOI_TINH}}</td>
                                    </tr>
                                    <tr>
                                        <td>Skype</td>
                                        <td>{{lienhe.SKYPE}}</td>
                                    </tr>
                                    <tr>
                                        <td>Facebook</td>
                                        <td>{{lienhe.FACEBOOK}}</td>
                                    </tr>
                                    <tr>
                                        <td>Số điện thoại 1:</td>
                                        <td>{{lienhe.SDT1}}</td>
                                    </tr>
                                    <tr>
                                        <td>Số điện thoại 2:</td>
                                        <td>{{lienhe.SDT2}}</td>
                                    </tr>
                                    <tr>
                                        <td>Sales phụ trách</td>
                                        <td>{{lienhe.HO_VA_TEN}}</td>
                                    </tr>
                                    <tr>
                                        <td>Ghi chú</td>
                                        <td>{{lienhe.GHI_CHU}}</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <button type="button" data-dismiss="modal" data-toggle="modal" data-target="#myEditLienHe" ng-click="EditLienHe(lienhe)" class="btn btn-default">Sửa</button>
                    </div>
                </div>
            </div>
        </div>
        <br />
        <!--end modal-->
        <!-- Modal Update lien he-->
        <div class="modal fade" id="myEditLienHe" role="dialog" tabindex="-1">
            <div class="modal-dialog modal-lg" style="width: 90%">
                <div class="modal-content" style="height: 100%">

                    <div class="modal-body">
                        <div class="form-group">
                            <label for="addmakhachhang" class="col-sm-2 control-label">ID Liên hệ</label>
                            <div class="col-sm-2">
                                <input type="text" class="form-control" disabled="disabled" id="addmakhachhang" ng-model="editlh.ID_LIEN_HE">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="addtencongty" class="col-sm-2 control-label">Mã khách hàng</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" disabled="disabled" id="addtencongty" ng-model="editlh.MA_KHACH_HANG">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="addtencongty" class="col-sm-2 control-label">Người liên hệ</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control"  id="addtencongty" ng-model="editlh.NGUOI_LIEN_HE">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="addvpgiaodich" class="col-sm-2 control-label">Chức vụ</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="addvpgiaodich" ng-model="editlh.CHUC_VU">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="adddiachixuathoadon" class="col-sm-2 control-label">Phòng ban</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="adddiachixuathoadon" ng-model="editlh.PHONG_BAN">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="addmasothue" class="col-sm-2 control-label">Ngày sinh</label>
                            <div class="col-sm-2">
                                <input type="text" class="form-control" ng-model="editlh.NGAY_SINH">
                            </div>
                            <label for="addwebsite" class="col-sm-1 control-label">Giới tính</label>
                            <div class="col-sm-2">
                                <input type="text" class="form-control" id="addwebsite" ng-model="editlh.GIOI_TINH">
                            </div>
                            <label for="addsomayban" class="col-sm-1 control-label">Email cá nhân</label>
                            <div class="col-sm-2">
                                <input type="tel" class="form-control" disabled="disabled" id="addsomayban" ng-model="editlh.EMAIL_CA_NHAN">
                            </div>
                            <label for="addemail" class="col-sm-1 control-label">Số điện thoại 1</label>
                            <div class="col-sm-1">
                                <input type="text" class="form-control" disabled="disabled" id="addemail" ng-model="editlh.SDT1">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="addsongayduocno" class="col-sm-2 control-label">Skype</label>
                            <div class="col-sm-2">
                                <input type="text" class="form-control" id="addsongayduocno" ng-model="editlh.SKYPE">
                            </div>
                            <label for="addsonotoida" class="col-sm-1 control-label">Facebook</label>
                            <div class="col-sm-2">
                                <input type="text" class="form-control" id="addsonotoida" ng-model="editlh.FACEBOOK">
                            </div>
                            <label for="addfax" class="col-sm-1 control-label">Email công ty</label>
                            <div class="col-sm-2">
                                <input type="text" class="form-control" id="addfax" ng-model="editlh.EMAIL_CONG_TY">
                            </div>
                            <label for="addemail" class="col-sm-1 control-label">Số điện thoại 2</label>
                            <div class="col-sm-1">
                                <input type="text" class="form-control" id="addemail" ng-model="editlh.SDT2">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">Sales phụ trách</label>
                            <div class="col-sm-2">
                                <select ng-model="editlh.SALES_PHU_TRACH" class="form-control input-md" disabled="disabled">
                                    <option ng-repeat="abc in list_nhanvienkd" value="{{abc.USERNAME}}">{{abc.HO_VA_TEN}}</option>
                                </select>
                            </div>
                            <label class="col-sm-1 control-label">Sales cũ</label>
                            <div class="col-sm-1">
                                <input type="checkbox" id="addemail" ng-model="editlh.SALES_CU">
                            </div>
                            <label class="col-sm-1 control-label">Sales mới</label>
                            <div class="col-sm-1">
                                <input type="checkbox" id="addemail" ng-model="editlh.SALES_MOI">
                            </div>
                            <label class="col-sm-1 control-label">Trạng thái</label>
                            <div class="col-sm-1">
                                <input type="checkbox" id="addemail" ng-model="editlh.TRANG_THAI">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="addmasothue" class="col-sm-2 control-label">Ngày kết thúc phụ trách</label>
                            <div class="col-sm-2">
                                <input type="text" class="form-control" ng-model="editlh.NGAY_KET_THUC_PHU_TRACH">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="addghichu" class="col-sm-2 control-label">Ghi chú</label>
                            <div class="col-sm-10">
                                <textarea class="form-control" rows="3" id="addghichu" ng-model="editlh.GHI_CHU"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="save" name="save" class="btn" data-dismiss="modal" ng-click="savelienhe(editlh.ID_LIEN_HE)">Save</button>
                        <button id="exit" name="exit" class="btn" data-dismiss="modal">Exit</button>
                    </div>
                </div>
            </div>
        </div>
        <!--end modal-->
        <!-- Modal chi tiet khach hang -->
        <div class="modal fade chitietkhachhang" id="chitietkhachhang" role="dialog" tabindex="-1">
            <div class="modal-dialog modal-lg" style="width:80%;">
                <div class="modal-content" style="height: 100%;">

                    <div class="modal-body">
                        <div class="col-md-3">
                            <img ng-src="~/Content/Images/KhachHang/{{item.LOGO}}" style="width: 90%;height: 250px;" />
                        </div>
                        <div class="col-md-9">
                            <div style="margin-bottom: 5%;" class="col-md-12">
                                <h1>{{item.TEN_CONG_TY | uppercase}}</h1>
                                <div class="col-md-3 detail">Mã khách hàng: {{item.MA_KHACH_HANG}}</div>
                                <div class="col-md-2 detail">Tỉnh: {{item.TINH}}</div>
                                <div class="col-md-2 detail">Quốc gia: {{item.QUOC_GIA}}</div>
                            </div>
                            <div>
                                <ul class="nav nav-tabs">
                                    <li class="active"><a data-toggle="tab" href="#chitiet">Thông tin chi tiết</a></li>
                                    <li><a data-toggle="tab" href="#lienhe">Liên hệ</a></li>
                                    <li><a data-toggle="tab" href="#taikhoan">Tài khoản</a></li>
                                </ul>
                                <div class="tab-content">
                                    <!--Tab chi tiết hàng hóa-->
                                    <div id="chitiet" class="tab-pane fade in active">
                                        <div class="col-md-12" style="box-shadow: 3px 3px 3px #ddd">
                                            <div class="col-md-6">
                                                <table class="table noborder">
                                                    <tr>
                                                        <td>Văn phòng giao dịch</td>
                                                        <td>{{item.VAN_PHONG_GIAO_DICH}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Địa chỉ xuất hóa đơn:</td>
                                                        <td>{{item.DIA_CHI_XUAT_HOA_DON}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Mã số thuế:</td>
                                                        <td>{{item.MST}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Điện thoại:</td>
                                                        <td>{{item.HOTLINE}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Email:</td>
                                                        <td>{{item.EMAIL}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Fax:</td>
                                                        <td>{{item.FAX}}</td>
                                                    </tr>
                                                </table>
                                            </div>
                                            <div class="col-md-6">
                                                <table class="table noborder">
                                                    <tr>
                                                        <td>Website</td>
                                                        <td>{{item.WEBSITE}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Điều khoản thanh toán</td>
                                                        <td>{{item.DIEU_KHOAN_THANH_TOAN}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Số ngày được nợ</td>
                                                        <td>{{item.SO_NGAY_DUOC_NO}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Số nợ tối đa</td>
                                                        <td>{{item.SO_NO_TOI_DA}}</td>
                                                    </tr>
                                                    <tr>
                                                        <td>Ghi chú</td>
                                                        <td>{{item.GHI_CHU}}</td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                        <button type="button" data-dismiss="modal" data-toggle="modal" data-target="#myEdit" ng-click="edit(item)" class="btn btn-default">Sửa</button>
                                    </div>
                                    <div id="lienhe" class="tab-pane fade">
                                        <div class="col-md-12">
                                            <table class="table">
                                                <thead class="table-header-popup">
                                                    <tr>
                                                        <th style="text-align: center">Người liên hệ</th>
                                                        <th style="text-align: center">Chức vụ</th>
                                                        <th style="text-align: center">Email</th>
                                                        <th style="text-align: center">SĐT</th>
                                                        <th style="text-align: center">Skype</th>
                                                        <th style="text-align: center">Sale phụ trách</th>
                                                        <th style="text-align: center">Loại sales</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr ng-repeat="lienhe in list_lienhe" ng-click="details(lienhe)" class="hover" ng-class-odd="'odd'" ng-class-even="'even'">
                                                        <td data-dismiss="modal" data-toggle="modal" data-target="#chitietlienhe">{{lienhe.NGUOI_LIEN_HE}}</td>
                                                        <td data-dismiss="modal" data-toggle="modal" data-target="#chitietlienhe">{{lienhe.CHUC_VU}}</td>
                                                        <td data-dismiss="modal" data-toggle="modal" data-target="#chitietlienhe">{{lienhe.EMAIL_CA_NHAN}}</td>
                                                        <td data-dismiss="modal" data-toggle="modal" data-target="#chitietlienhe">{{lienhe.SDT1}}</td>
                                                        <td data-dismiss="modal" data-toggle="modal" data-target="#chitietlienhe">{{lienhe.SKYPE}}</td>
                                                        <td data-dismiss="modal" data-toggle="modal" data-target="#chitietlienhe">{{lienhe.HO_VA_TEN}}</td>
                                                        <td data-dismiss="modal" data-toggle="modal" data-target="#chitietlienhe" ng-if="lienhe.SALES_MOI == true">Sales mới</td>
                                                        <td data-dismiss="modal" data-toggle="modal" data-target="#chitietlienhe" ng-if="lienhe.SALES_CU == true">Sales cũ</td>
                                                    </tr>
                                                </tbody>
                                                <tfoot>
                                                    <tr>
                                                        <td>
                                                            <button type="button" ng-click="trasnfer(item)" class="btn btn-default" data-dismiss="modal" data-toggle="modal" data-target="#newlienhe">Thêm mới</button>
                                                        </td>
                                                    </tr>                                                   
                                                </tfoot>
                                            </table>                                           
                                        </div>                                     
                                    </div>

                                    <div id="taikhoan" class="tab-pane fade">
                                        <table class="table">
                                            <thead class="table-header-popup">
                                                <tr>
                                                    <th style="text-align: center">Số tài khoản</th>
                                                    <th style="text-align: center">Tên tài khoản</th>
                                                    <th style="text-align: center">Tên ngân hàng</th>
                                                    <th style="text-align: center">Chi nhánh</th>
                                                    <th style="text-align: center">Tỉnh/Thành phố</th>
                                                    <th style="text-align: center">Ghi chú</th>
                                                    <th style="text-align: center">Loại tài khoản</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="taikhoan in list_taikhoankh" ng-click="details(taikhoan)" class="hover" ng-class-odd="'odd'" ng-class-even="'even'">
                                                    <td>{{taikhoan.SO_TAI_KHOAN}}</td>
                                                    <td>{{taikhoan.TEN_TAI_KHOAN}}</td>
                                                    <td>{{taikhoan.TEN_NGAN_HANG}}</td>
                                                    <td>{{taikhoan.CHI_NHANH}}</td>
                                                    <td>{{taikhoan.TINH_TP}}</td>
                                                    <td>{{taikhoan.GHI_CHU}}</td>
                                                    <td>{{taikhoan.TEN_LOAI}}</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                        <button type="button" ng-click="transfer(item)" class="btn btn-default" data-dismiss="modal" data-toggle="modal" data-target="#newtaikhoan">Thêm mới</button>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="exit" name="exit" class="btn" data-dismiss="modal">Exit</button>
                    </div>
                </div>

            </div>
        </div>
        <!--end modal-->
        <!-- Modal them moi lien he -->
        <div class="modal fade" id="newlienhe" role="dialog" tabindex="-1">
            <div class="modal-dialog modal-lg" style="width: 90%">
                <div class="modal-content" style="height: 100%">

                    <div class="modal-body">
                        <div class="form-group">
                            <label for="addtencongty" class="col-sm-2 control-label">Người liên hệ</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="addtencongty" ng-model="nguoi_lien_he">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="addvpgiaodich" class="col-sm-2 control-label">Chức vụ</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="addvpgiaodich" ng-model="chuc_vu">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="adddiachixuathoadon" class="col-sm-2 control-label">Phòng ban</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="adddiachixuathoadon" ng-model="phong_ban">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="addmasothue" class="col-sm-2 control-label">Ngày sinh</label>
                            <div class="col-sm-2">
                                <input type="text" class="form-control" ng-model="ngay_sinh">
                            </div>
                            <label for="addwebsite" class="col-sm-1 control-label">Giới tính</label>
                            <div class="col-sm-2">
                                <input type="text" class="form-control" id="addwebsite" ng-model="gioi_tinh">
                            </div>
                            <label for="addsomayban" class="col-sm-1 control-label">Email cá nhân</label>
                            <div class="col-sm-2">
                                <input type="tel" class="form-control" id="addsomayban" ng-model="email_ca_nhan">
                            </div>
                            <label for="addemail" class="col-sm-1 control-label">Số điện thoại 1</label>
                            <div class="col-sm-1">
                                <input type="text" class="form-control" id="addemail" ng-model="so_dien_thoai1">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="addsongayduocno" class="col-sm-2 control-label">Skype</label>
                            <div class="col-sm-2">
                                <input type="text" class="form-control" id="addsongayduocno" ng-model="skype">
                            </div>
                            <label for="addsonotoida" class="col-sm-1 control-label">Facebook</label>
                            <div class="col-sm-2">
                                <input type="text" class="form-control" id="addsonotoida" ng-model="facebook">
                            </div>
                            <label for="addfax" class="col-sm-1 control-label">Email công ty</label>
                            <div class="col-sm-2">
                                <input type="text" class="form-control" id="addfax" ng-model="email_cong_ty">
                            </div>
                            <label for="addemail" class="col-sm-1 control-label">Số điện thoại 2</label>
                            <div class="col-sm-1">
                                <input type="text" class="form-control" id="addemail" ng-model="so_dien_thoai2">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">Sales phụ trách</label>
                            <div class="col-sm-2">
                                <div class="input-group">
                                    <input type="text" class="form-control" ng-model="nvkd.HO_VA_TEN" value="{{nvkd.HO_VA_TEN}}" ng-change="onNhanVienFind()" ng-focus="showtable_ho_va_ten = true">
                                    <input type="hidden" class="form-control" ng-model="nvkd.USERNAME" ng-change="onNhanVienFind()" ng-focus="showtable_ho_va_ten = true">
                                    <div class="input-group-btn">
                                        <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" ng-click="showtable_ho_va_ten = !showtable_ho_va_ten" aria-haspopup="true" aria-expanded="false">
                                            <span class="caret"></span>
                                        </button>
                                        <div class="dropdown-menu dropdown-menu-center borderRadius0 padding0" style="display: block" ng-show="showtable_ho_va_ten">
                                            <div class="table-responsive" style="max-height: 280px">
                                                <table class="table table-striped table-hover" st-pagination-scroll st-table="staffsCollection" st-safe-src="arrayNVFinded">
                                                    <tbody>
                                                        <tr ng-repeat="staff in staffsCollection" style="cursor:pointer" ng-click="showInfoStaff(staff)">
                                                            <td>{{staff.HO_VA_TEN}}</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <label class="col-sm-1 control-label">Sales mới</label>
                            <div class="col-sm-1">
                                <input type="checkbox"  id="addemail" ng-model="sales_moi">
                            </div>
                            <label class="col-sm-1 control-label">Sales cũ</label>
                            <div class="col-sm-1">
                                <input type="checkbox"  id="addemail" ng-model="sales_cu">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="addghichu" class="col-sm-2 control-label">Ghi chú</label>
                            <div class="col-sm-10">
                                <textarea class="form-control" rows="3" id="addghichu" ng-model="ghi_chu_lh"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="save" name="save" class="btn btn-default" data-dismiss="modal" ng-click="addnew(item.MA_KHACH_HANG)">Thêm</button>
                        <button id="exit" name="exit" class="btn" data-dismiss="modal">Exit</button>
                    </div>
                </div>
            </div>
        </div>
        <!--end modal-->
        <!-- Modal thêm mới tài khoản -->
        <div class="modal fade" id="newtaikhoan" role="dialog">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">

                    <div class="modal-body">
                        <form class="form-horizontal" name="myForm" novalidate>
                            <fieldset>
                                <!-- Form Name -->
                                <legend>Add New Maker</legend>
                                <!-- Text input-->
                                <div class="form-group">
                                    <label class="col-md-2 control-label" for="name">Số tài khoản: </label>
                                    <div class="col-md-10">
                                        <input type="text" placeholder="Maker Code" class="form-control input-md" ng-model="so_tai_khoan">
                                    </div>
                                </div>
                                <!-- Text input-->
                                <div class="form-group">
                                    <label class="col-md-2 control-label" for="name">Tên tài khoản: </label>
                                    <div class="col-md-10">
                                        <input type="text" placeholder="Maker Name" class="form-control input-md" ng-model="ten_tai_khoan">
                                    </div>
                                </div>
                                <!-- Text input-->
                                <div class="form-group">
                                    <label class="col-md-2 control-label" for="name">Tên ngân hàng : </label>
                                    <div class="col-md-10">
                                        <input type="text" placeholder="Maker's Parent Code " class="form-control input-md" ng-model="ten_ngan_hang">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-2 control-label" for="name">Chi nhánh: </label>
                                    <div class="col-md-10">
                                        <input type="text" placeholder="Note" class="form-control input-md" ng-model="chi_nhanh">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="col-md-2 control-label" for="name">Tỉnh/Thành phố: </label>
                                    <div class="col-md-10">
                                        <input type="text" placeholder="Note" class="form-control input-md" ng-model="tinh_tp">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="addghichu" class="col-sm-2 control-label">Ghi chú</label>
                                    <div class="col-sm-10">
                                        <textarea class="form-control" rows="3" placeholder="Ghi chú" id="addghichu" ng-model="ghi_chu_tk"></textarea>
                                    </div>
                                </div>
                                <div class="form-group" style="margin-top: 50px;">
                                    <label class="col-sm-2 control-label">Loại tài khoản</label>
                                    <div class="col-sm-6">
                                        <select ng-model="loai_tai_khoan" class="form-control input-md">
                                            <option ng-repeat="loaitaikhoan in list_loaitaikhoan" value="{{loaitaikhoan.MA_LOAI}}">{{loaitaikhoan.TEN_LOAI}}</option>
                                        </select>
                                    </div>
                                </div>
                                <!-- Button (Double) -->
                            </fieldset>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <div class="form-group">
                            <label class="col-md-4 control-label" for="anmelden"></label>
                            <div class="col-md-8 addnew">
                                <button id="addnew" name="addnew" class="btn" ng-click="addnewtk(item.MA_KHACH_HANG)" data-dismiss="modal">Add New</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                <button id="exit" name="exit" class="btn" data-dismiss="modal">Exit</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--end modal-->



        <table id="example" class="table" cellspacing="0">
            <thead>
                <tr>
                    <th>Mã khách hàng</th>
                    <th>Tên công ty</th>
                    <th>Email</th>
                    <th>Tỉnh</th>
                    <th>Quốc gia</th>
                    <th>Phân loại khách</th>
                    <th>Sales phụ trách</th>
                </tr>
            </thead>
            <tbody>
                <tr dir-paginate="item in filtered = (list_kh | filter: {TEN_CONG_TY:search_text}) | itemsPerPage:15 | orderBy: 'item.TEN_CONG_TY'" ng-click="transfer(item);get_lienhe(item.MA_KHACH_HANG);get_taikhoan(item.MA_KHACH_HANG)" class="hover" ng-class-odd="'odd'" ng-class-even="'even'">
                    <td class="text-center" data-toggle="modal" data-target="#chitietkhachhang">{{item.MA_KHACH_HANG}}</td>
                    <td class="text-left" data-toggle="modal" data-target="#chitietkhachhang">{{item.TEN_CONG_TY}}</td>
                    <td class="text-center" data-toggle="modal" data-target="#chitietkhachhang">{{item.EMAIL}}</td>
                    <td class="text-center" data-toggle="modal" data-target="#chitietkhachhang">{{ item.TINH}}</td>
                    <td class="text-center" data-toggle="modal" data-target="#chitietkhachhang">{{item.QUOC_GIA}}</td>
                    <td class="text-center" data-toggle="modal" data-target="#chitietkhachhang">{{item.TEN_LOAI_KHACH}}</td>
                    <td class="text-center" data-toggle="modal" data-target="#chitietkhachhang">{{item.SALES_PHU_TRACH}}</td>
                </tr>
                <!--Detail row-->

            </tbody>
            <tfoot>
                <tr>
                    <td colspan="9" style="border: none !important">
                        <dir-pagination-controls max-size="12" style="float:right;"
                                                 direction-links="true"
                                                 boundary-links="true">
                        </dir-pagination-controls>
                    </td>
                </tr>
            </tfoot>
        </table>
    </div>





    <script>
    (function () {

        var bar = $('.progress-bar');
        var percent = $('.progress-bar');
        var status = $('#status');

        $('form').ajaxForm({
            beforeSend: function () {
                status.empty();
                var percentVal = '0%';
                bar.width(percentVal)
                percent.html(percentVal);
            },
            uploadProgress: function (event, position, total, percentComplete) {
                var percentVal = percentComplete + '%';
                bar.width(percentVal)
                percent.html(percentVal);
            },
            success: function () {
                var percentVal = '100%';
                bar.width(percentVal)
                percent.html(percentVal);
            },
            complete: function (xhr) {
                status.html(xhr.responseText);
            }
        });


    })();
    </script>
</div>